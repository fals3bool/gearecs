<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>FalsECS - Components</title>
    <link href="../css/style.css" rel="stylesheet">
  </head>

  <body>
    <table>

      <tr class="falsecs-docs">
        <td>
          <h2>Components</h2>

          <p>
          A <b>Signature</b> is a bitset that represents the entity's components. <br>
          Eg. The signature "01001" means the entity has the components with ID '0' and '3'. <br><br>
          A <b>Component</b> characterizes an entity as possessing a particular aspect, and holds the data
          needed to model that aspect.
          </p>

          <h2>Example</h2>

          <pre><code class="language-c">
#include &lt;ecs/registry.h&gt;
#include &lt;stdio.h&gt;

typedef struct {
  float x;
  float y;
} Position;

int main(void) {

  Registry *r = ecs_registry();
  Entity e = ecs_entity(r);

  // - - - - - - - - - - //
  // REGISTER COMPONENTS //
  // - - - - - - - - - - //

  // The registry stores the component Position under its ID and name
  // "Position". It also creates a local-scope variable called 'Position_' that
  // stores the component ID.
  ecs_component(r, Position);

  // Using that local-scope variable, a component can be added.
  Position pos = {10, 10};
  ecs_add_component(r, e, Position_, &pos);

  // otherwise 'ecs_cid' retrieves the component id using the registry's pair
  // (string, int). then add a component using that id.
  Component c = ecs_cid(r, "Position");
  ecs_add_component(r, e, c, &pos);
  // this functions uses memcpy, 'pos' can be changed without changing the
  // component itself.
  pos.x = 200;

  // Once the component is added, the registry stores a signature under the
  // entity id. It can be recreated using the component id.
  Signature s = (1 &lt;&lt; ecs_cid(r, "Position")); // s = 000...00001

  // - - - - - - - - - - //
  // RETRIEVE COMPONENTS //
  // - - - - - - - - - - //

  // Retrieve the component by its id.
  Position *p = ecs_get_component(r, e, c);
  printf("Position: {%.2f, %.2f}\n", p->x, p->y);

  // - - -  - - - //
  // USING MACROS //
  // - - -  - - - //

  // 'ecs_add' searches for the id using ecs_cid()
  ecs_add(r, e, Position, {20, 12});

  // 'ecs_add_local' uses the local-scope variable 'Position_'
  ecs_add_local(r, e, Position, {10, 20});

  // 'ecs_add_obj' adds a component by a defined struct.
  // 'ecs_add' always cast to 'Position' leading to an error in these cases.
  ecs_add_obj(r, e, Position, pos);

  // 'ecs_get' retrieves the component by its id using 'ecs_cid'.
  p = ecs_get(r, e, Position);
  printf("Position: {%.2f, %.2f}", p->x, p->y);

  return 0;
}
          </code></pre>

        </td>
      </tr>
    </table>

    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/c.min.js"></script>

    <script>
      hljs.highlightAll();
    </script>

  </body>

</html>
